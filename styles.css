/* ====================================
   B-Movie Ratings - Mobile-First CSS
   ==================================== */

:root {
  --bg: #0f1115;
  --bg-alt: #191c22;
  --panel: #1f242c;
  --panel-alt: #262d37;
  --border: #303945;
  --text: #e8eef5;
  --text-dim: #9aa8b9;
  --accent: #ff9d1d;
  --accent-glow: 255 157 29;
  --danger: #ff4d55;
  --radius-s: 8px;
  --radius: 14px;
  --radius-l: 20px;
  --shadow: 0 2px 8px -2px rgba(0 0 0 / 50%), 0 6px 20px -6px rgba(0 0 0 / 60%);
  --bottom-nav-height: 70px;
  --header-height: 60px;
  --safe-area-bottom: env(safe-area-inset-bottom, 0px);
  font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
html { height: 100%; scroll-behavior: smooth; }
body { 
  margin: 0; 
  min-height: 100%; 
  background: var(--bg); 
  color: var(--text); 
  -webkit-font-smoothing: antialiased;
  padding-bottom: calc(var(--bottom-nav-height) + var(--safe-area-bottom));
  overflow-x: hidden;
}

.visually-hidden { position: absolute; left: -9999px; width: 1px; height: 1px; overflow: hidden; }

/* ====================================
   MOBILE HEADER
   ==================================== */
.app-header {
  position: sticky;
  top: 0;
  z-index: 100;
  background: linear-gradient(180deg, #12161c 0%, #0d1014 100%);
  border-bottom: 1px solid var(--border);
  padding: 0;
}

.header-top {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  height: var(--header-height);
}

.menu-toggle {
  width: 44px;
  height: 44px;
  background: transparent;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius-s);
  transition: background 0.2s;
}
.menu-toggle:hover, .menu-toggle:focus { background: rgba(255 255 255 / 8%); }
.menu-toggle:active { background: rgba(255 255 255 / 12%); }

.hamburger {
  width: 22px;
  height: 2px;
  background: var(--text);
  position: relative;
  border-radius: 2px;
  transition: 0.3s;
}
.hamburger::before, .hamburger::after {
  content: '';
  position: absolute;
  width: 22px;
  height: 2px;
  background: var(--text);
  border-radius: 2px;
  transition: 0.3s;
}
.hamburger::before { top: -7px; }
.hamburger::after { top: 7px; }

.menu-toggle.active .hamburger { background: transparent; }
.menu-toggle.active .hamburger::before { transform: rotate(45deg); top: 0; }
.menu-toggle.active .hamburger::after { transform: rotate(-45deg); top: 0; }

.branding { flex: 1; text-align: center; }
.logo {
  margin: 0;
  font-family: 'Bangers', Impact, sans-serif;
  font-size: 1.6rem;
  background: linear-gradient(90deg, #ffce4f, #ff9d1d 50%, #ff7b4f);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  letter-spacing: 1px;
}

.sync-status {
  font-size: 0.6rem;
  text-transform: uppercase;
  letter-spacing: 1px;
  background: rgba(255 255 255 / 5%);
  padding: 6px 10px;
  border-radius: var(--radius-s);
  color: var(--text-dim);
}
.sync-status[data-mode="remote"] { background: rgba(100 200 120 / 15%); color: #8be79f; }

/* Mobile Menu Dropdown */
.mobile-menu {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.35s ease, padding 0.35s ease;
  background: linear-gradient(180deg, #0d1014 0%, #12161c 100%);
}
.mobile-menu.open {
  max-height: 300px;
  padding: 0 16px 16px;
}

.menu-content {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.user-box label {
  display: block;
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 1px;
  color: var(--text-dim);
  margin-bottom: 6px;
  font-weight: 600;
}
.user-box input {
  width: 100%;
  background: var(--panel);
  color: var(--text);
  border: 1px solid var(--border);
  padding: 14px 16px;
  border-radius: var(--radius-s);
  font-size: 16px; /* Prevents iOS zoom */
}

.score-tracker {
  background: rgba(255 157 29 / 8%);
  border: 1px solid rgba(255 157 29 / 15%);
  border-radius: var(--radius-s);
  padding: 12px;
}
.tracker-title {
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-weight: 600;
  color: var(--accent);
  margin-bottom: 8px;
}
.tracker-scores {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  font-size: 0.75rem;
}
.score-item-tracker {
  background: rgba(255 157 29 / 12%);
  border: 1px solid rgba(255 157 29 / 25%);
  padding: 4px 8px;
  border-radius: 4px;
  color: #ffb347;
  font-weight: 600;
}
.score-item-tracker.top-scorer {
  background: rgba(100 200 120 / 15%);
  border-color: rgba(139 231 159 / 30%);
  color: #8be79f;
}
.no-scores { color: var(--text-dim); font-style: italic; font-size: 0.7rem; }

/* ====================================
   BOTTOM NAVIGATION
   ==================================== */
.bottom-nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: calc(var(--bottom-nav-height) + var(--safe-area-bottom));
  background: linear-gradient(180deg, #1a1f26 0%, #12161c 100%);
  border-top: 1px solid var(--border);
  display: flex;
  justify-content: space-around;
  align-items: flex-start;
  padding-top: 8px;
  padding-bottom: var(--safe-area-bottom);
  z-index: 100;
}

.nav-item {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  background: transparent;
  border: none;
  color: var(--text-dim);
  padding: 8px 4px;
  cursor: pointer;
  transition: color 0.2s, transform 0.15s;
  -webkit-tap-highlight-color: transparent;
}
.nav-item:active { transform: scale(0.95); }
.nav-item.active { color: var(--accent); }
.nav-item.active .nav-icon { transform: scale(1.1); }

.nav-icon { font-size: 1.5rem; line-height: 1; }
.nav-label { font-size: 0.65rem; font-weight: 600; letter-spacing: 0.5px; }

/* ====================================
   MAIN LAYOUT - Mobile First
   ==================================== */
.layout.mobile-layout {
  display: block;
  padding: 16px;
  padding-bottom: calc(var(--bottom-nav-height) + 24px + var(--safe-area-bottom));
}

/* Panels as tabs - only show active one on mobile */
.mobile-panel {
  display: none;
}
.mobile-panel.active {
  display: block;
}

.panel {
  background: linear-gradient(145deg, var(--panel), var(--panel-alt));
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 20px;
  box-shadow: var(--shadow);
}

.panel h2 {
  margin: 0 0 16px;
  font-family: 'Bangers', Impact, sans-serif;
  font-size: 1.4rem;
  color: #ffce4f;
  letter-spacing: 1px;
}

.panel-header {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 16px;
}
.panel-header h2 { margin-bottom: 0; }

.filters {
  display: flex;
  gap: 8px;
}
.filters select, .filters input {
  flex: 1;
  background: var(--panel-alt);
  color: var(--text);
  border: 1px solid var(--border);
  padding: 12px;
  border-radius: var(--radius-s);
  font-size: 14px;
}
.filters input { min-width: 0; }

/* ====================================
   FORMS - Touch Optimized
   ==================================== */
.form-stack {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.field {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.field label {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-weight: 600;
  color: var(--text-dim);
}
.field input, .field textarea, .field select {
  background: var(--panel-alt);
  color: var(--text);
  border: 1px solid var(--border);
  padding: 14px 16px;
  border-radius: var(--radius-s);
  font-size: 16px; /* Prevents iOS zoom */
  font-family: inherit;
  resize: vertical;
}
.field input:focus, .field textarea:focus, .field select:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(var(--accent-glow) / 20%);
}

/* Buttons */
.btn {
  background: var(--panel-alt);
  color: var(--text);
  border: 1px solid var(--border);
  padding: 14px 20px;
  border-radius: var(--radius-s);
  font-weight: 600;
  font-size: 1rem;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  transition: all 0.2s;
  -webkit-tap-highlight-color: transparent;
}
.btn:active { transform: scale(0.98); }

.btn.primary {
  background: linear-gradient(135deg, #ffb347 0%, #ff9d1d 50%, #ff7b4f 100%);
  color: #1d1205;
  border: none;
  font-weight: 700;
  box-shadow: 0 4px 12px -2px rgba(var(--accent-glow) / 40%);
}
.btn.primary:active { box-shadow: 0 2px 6px -2px rgba(var(--accent-glow) / 40%); }

.btn.ghost {
  background: transparent;
  color: var(--text-dim);
  border: 1px solid var(--border);
}
.btn.ghost:hover { color: var(--text); background: rgba(255 255 255 / 5%); }

.btn.small { padding: 10px 14px; font-size: 0.85rem; }
.btn.danger { background: var(--danger); color: #fff; border: none; }

.btn-block { width: 100%; }
.btn-group { display: flex; gap: 10px; }
.btn-group .btn { flex: 1; }

.rate-btn { width: 100%; margin-top: 12px; }

/* ====================================
   MOVIE CARDS - Mobile Optimized
   ==================================== */
.cards {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.movie-card {
  background: linear-gradient(160deg, #212831, #1a2027);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 16px;
  box-shadow: var(--shadow);
}

.movie-head {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 12px;
  margin-bottom: 8px;
}
.movie-title {
  margin: 0;
  font-size: 1.1rem;
  font-weight: 600;
  line-height: 1.3;
}
.year {
  font-size: 0.75rem;
  background: rgba(255 255 255 / 8%);
  padding: 4px 8px;
  border-radius: var(--radius-s);
  color: var(--text-dim);
  white-space: nowrap;
}

.notes {
  margin: 0 0 12px;
  font-size: 0.85rem;
  color: var(--text-dim);
  line-height: 1.4;
}

.scores-wrap { display: flex; flex-direction: column; gap: 10px; }
.score-row { display: flex; flex-wrap: wrap; gap: 6px; }
.total-line {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}
.total-badge {
  background: linear-gradient(135deg, #ffb347, #ff9d1d);
  color: #1d1205;
  padding: 6px 12px;
  border-radius: 999px;
  font-size: 0.8rem;
  font-weight: 700;
}
.rater-count { font-size: 0.75rem; color: var(--text-dim); }

.cat-badge {
  background: rgba(255 255 255 / 5%);
  border: 1px solid var(--border);
  padding: 6px 10px;
  border-radius: var(--radius-s);
  font-size: 0.65rem;
  font-weight: 600;
  color: var(--text-dim);
  font-family: 'Share Tech Mono', monospace;
}
.cat-badge[data-empty="false"] { color: var(--accent); }
.cat-badge.bonus { opacity: 0.7; }
.cat-badge.bonus[data-empty="false"] { color: #c29dff; }

.individual-reviews { margin-top: 12px; }
.reviews-toggle {
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--text-dim);
  cursor: pointer;
  padding: 8px 0;
}
.reviews-list { display: flex; flex-direction: column; gap: 10px; margin-top: 10px; }

.user-review {
  background: rgba(255 255 255 / 3%);
  border: 1px solid var(--border);
  padding: 12px;
  border-radius: var(--radius-s);
}
.reviewer-header { display: flex; justify-content: space-between; margin-bottom: 8px; }
.reviewer-name { font-size: 0.8rem; font-weight: 600; }
.reviewer-total { font-size: 0.75rem; color: var(--accent); font-weight: 600; }
.reviewer-scores { display: flex; flex-wrap: wrap; gap: 4px; }
.score-item {
  background: rgba(255 255 255 / 5%);
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 0.65rem;
  color: var(--text-dim);
}
.score-item.bonus { color: #c29dff; }

.card-actions {
  display: flex;
  justify-content: flex-end;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--border);
}
.delete-btn { color: var(--text-dim); }
.delete-btn:hover { color: var(--danger); }

/* No results */
#moviesList.no-results:before {
  content: "No movies found.";
  color: var(--text-dim);
  font-size: 0.9rem;
  text-align: center;
  padding: 40px 20px;
  display: block;
}

/* ====================================
   RATING DIALOG - Mobile Optimized
   ==================================== */
#rateDialog {
  position: fixed;
  inset: 0;
  margin: auto;
  width: calc(100% - 32px);
  max-width: 400px;
  max-height: calc(100vh - 100px);
  background: linear-gradient(160deg, #1d232b, #14181d);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: var(--radius-l);
  padding: 24px;
  box-shadow: 0 20px 50px -10px rgba(0 0 0 / 80%);
  overflow-y: auto;
}
#rateDialog::backdrop { background: rgba(0 0 0 / 80%); -webkit-backdrop-filter: blur(4px); backdrop-filter: blur(4px); }

.dialog-title {
  margin: 0 0 20px;
  font-family: 'Bangers', Impact, sans-serif;
  font-size: 1.2rem;
  color: #ffce4f;
}

.cat-grid {
  display: flex;
  flex-direction: column;
  gap: 14px;
  margin-bottom: 20px;
}
.cat-grid label {
  display: flex;
  flex-direction: column;
  gap: 6px;
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  font-weight: 600;
  color: var(--text-dim);
}
.cat-grid label.bonus-category {
  opacity: 0.8;
  border-top: 1px solid var(--border);
  padding-top: 14px;
  margin-top: 6px;
}
.cat-grid label small { font-size: 0.6rem; color: #9d7bff; }
.cat-grid input {
  background: var(--panel-alt);
  border: 1px solid var(--border);
  color: var(--text);
  padding: 14px;
  border-radius: var(--radius-s);
  font-size: 18px;
  font-weight: 600;
  text-align: center;
}
.cat-grid input:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(var(--accent-glow) / 20%);
}

.dialog-actions {
  display: flex;
  gap: 10px;
}
.dialog-actions .btn { flex: 1; }

/* ====================================
   WINNER PANEL
   ==================================== */
.winner-display { margin-top: 20px; }
.winner-badge {
  background: linear-gradient(135deg, #2d4a1e, #1f3315);
  border: 2px solid #4a7c2a;
  padding: 16px;
  border-radius: var(--radius);
  display: flex;
  align-items: center;
  gap: 12px;
}
.winner-icon { font-size: 2rem; }
.winner-info { flex: 1; }
.winner-title { font-size: 1rem; font-weight: 600; color: #8be79f; margin-bottom: 4px; }
.winner-subtitle { font-size: 0.8rem; color: var(--text-dim); margin-bottom: 8px; }
.winner-theme {
  font-size: 0.75rem;
  color: #ffce4f;
  font-weight: 500;
  background: rgba(255 206 79 / 10%);
  padding: 6px 10px;
  border-radius: var(--radius-s);
  border: 1px solid rgba(255 206 79 / 20%);
}

.winner-theme-editor { margin-top: 16px; }
.winner-theme-editor label {
  display: block;
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-weight: 600;
  color: var(--text-dim);
  margin-bottom: 8px;
}
.theme-input-group { display: flex; gap: 8px; }
.theme-input-group input { flex: 1; }
.theme-input-group .btn { flex-shrink: 0; }

/* ====================================
   RULES PANEL
   ==================================== */
.rules-subtitle {
  font-size: 0.85rem;
  color: var(--text-dim);
  margin: -8px 0 16px;
}

#rules-panel details {
  background: rgba(255 255 255 / 3%);
  border: 1px solid var(--border);
  border-radius: var(--radius-s);
  margin-bottom: 10px;
  overflow: hidden;
}
#rules-panel summary {
  padding: 14px 16px;
  font-weight: 600;
  font-size: 0.9rem;
  cursor: pointer;
  font-family: 'Share Tech Mono', monospace;
}
#rules-panel details[open] summary { border-bottom: 1px solid var(--border); }

.rules-list {
  margin: 0;
  padding: 14px 16px 14px 32px;
  font-size: 0.85rem;
  line-height: 1.5;
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.rules-list.numbered { list-style: decimal; padding-left: 36px; }
.rules-list ul { margin: 8px 0 0 16px; padding: 0; list-style: disc; }

.mini-note {
  font-size: 0.7rem;
  color: var(--text-dim);
  margin: 8px 0 0;
  padding: 0 16px 14px;
}

/* ====================================
   FOOTER
   ==================================== */
.app-footer {
  text-align: center;
  padding: 20px 16px;
  font-size: 0.7rem;
  color: var(--text-dim);
  font-family: 'Share Tech Mono', monospace;
}

/* ====================================
   B-MOVIE THEME EFFECTS
   ==================================== */
body.theme-bmovie {
  background:
    radial-gradient(circle at 15% 20%, rgba(255 30 60 / 8%), transparent 50%),
    radial-gradient(circle at 85% 70%, rgba(255 180 40 / 6%), transparent 50%),
    var(--bg);
}

.theme-bmovie .logo {
  text-shadow: 2px 2px 0 #3d0d00, 3px 3px 8px rgba(0 0 0 / 60%);
}

/* ====================================
   SCROLLBARS
   ==================================== */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: #2d333b; border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background: #3a424c; }

/* ====================================
   ANIMATIONS
   ==================================== */
@media (prefers-reduced-motion: no-preference) {
  .movie-card { animation: slideUp 0.4s ease; }
  @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } }
  
  .mobile-panel.active { animation: fadeIn 0.3s ease; }
  @keyframes fadeIn { from { opacity: 0; } }
}

/* Error animation */
.error { animation: shake 0.4s ease; }
@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-8px); }
  75% { transform: translateX(8px); }
}

/* ====================================
   DESKTOP BREAKPOINTS (Optional)
   ==================================== */
@media (min-width: 768px) {
  :root {
    --bottom-nav-height: 0px;
  }
  
  body { padding-bottom: 0; }
  
  .bottom-nav { display: none; }
  
  .layout.mobile-layout {
    display: grid;
    grid-template-columns: 300px 1fr;
    gap: 24px;
    padding: 24px;
    max-width: 1200px;
    margin: 0 auto;
  }
  
  .mobile-panel {
    display: block !important;
  }
  
  #movies-section { grid-column: 2; grid-row: 1 / 4; }
  #add-movie-panel { grid-column: 1; grid-row: 1; }
  #winner-panel { grid-column: 1; grid-row: 2; }
  #rules-panel { grid-column: 1; grid-row: 3; }
  
  .cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 20px;
  }
  
  .panel-header { flex-direction: row; justify-content: space-between; align-items: center; }
  
  .menu-toggle { display: none; }
  .mobile-menu { 
    max-height: none !important;
    overflow: visible;
    padding: 0 16px 16px !important;
    display: block;
  }
  .menu-content {
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
  }
  .user-box { width: 240px; }
  .score-tracker { flex: 1; max-width: 400px; }
}

@media (min-width: 1024px) {
  .layout.mobile-layout {
    grid-template-columns: 340px 1fr;
    gap: 32px;
    padding: 32px;
  }
}
